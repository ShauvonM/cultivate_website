{"version":3,"sources":["../src/ts/app/component/calendar.component.ts"],"names":[],"mappings":"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","file":"calendar.component.js","sourcesContent":["import {\r\n    Component,\r\n    OnInit\r\n} from '@angular/core';\r\nimport { Router }   from '@angular/router';\r\n\r\nimport moment = require('moment');\r\n\r\nimport { AppComponent } from \"./app.component\";\r\n\r\nimport { Lab, LabService } from \"../service/lab.service\";\r\nimport DateUtils from \"../util/date.utils\";\r\n\r\nclass DateInfo {\r\n    date: number;\r\n    today?: boolean;\r\n    labs?: Lab[];\r\n}\r\n\r\n@Component({\r\n    moduleId: module.id,\r\n    selector: 'cultivate-calendar',\r\n    templateUrl: '../template/calendar.component.html'\r\n})\r\nexport class CalendarComponent implements OnInit {\r\n\r\n    scrollpos: number;\r\n\r\n    date: moment.Moment;\r\n    today: moment.Moment;\r\n    dateInfo: [DateInfo[]];\r\n\r\n    month: string;\r\n\r\n    constructor(\r\n        private _app: AppComponent,\r\n        private router: Router,\r\n        private labService: LabService\r\n    ) {}\r\n\r\n    ngOnInit(): void {\r\n        this.today = moment();\r\n        this.date = this.today.clone().set(\"date\", 1);\r\n        this.labService.getLabs(\"all\")\r\n            .then((labs) => {\r\n                this.setupCalendar();\r\n            });\r\n    }\r\n\r\n    onScroll(scrollpos): void {\r\n        this.scrollpos = scrollpos;\r\n    }\r\n\r\n    prevMonth(): void {\r\n        this.date.subtract(\"M\", 1);\r\n        this.setupCalendar();\r\n    }\r\n\r\n    nextMonth(): void {\r\n        this.date.add(\"M\", 1);\r\n        this.setupCalendar();\r\n    }\r\n\r\n    clickLab(lab: Lab): void {\r\n        this.router.navigate(['/classes', lab.uuid]);\r\n    }\r\n\r\n    getShortTimeString(lab: Lab): string {\r\n        return DateUtils.getShortTimeForLab(lab);\r\n    }\r\n\r\n    setupCalendar(): void {\r\n        this.month = this.date.format(DateUtils.MONTH_YEAR);\r\n\r\n        let dateDay:number = parseInt(this.date.format('d'));\r\n        this.dateInfo = [[]];\r\n        this.dateInfo[0] = [];\r\n        for (let day = 0; day < dateDay; day++) {\r\n            this.dateInfo[0].push({\r\n                date: 0\r\n            });\r\n        }\r\n        \r\n        let week = 0;\r\n        for (let day = 1; day <= this.date.daysInMonth(); day++) {\r\n            this.dateInfo[week].push({\r\n                date: day,\r\n                today: this.date.get('M') == this.today.get('M') && day == this.today.get('date'),\r\n                labs: this.labService.getLabsForDate(this.date.clone().set(\"date\", day))\r\n            });\r\n\r\n            dateDay++;\r\n            if (day < this.date.daysInMonth()) {\r\n                if (dateDay >= 7) {\r\n                    dateDay = 0;\r\n                    week++;\r\n                    this.dateInfo[week] = [];\r\n                }\r\n            }\r\n        }\r\n\r\n        // finish out the week\r\n        while (dateDay < 7) {\r\n            this.dateInfo[week].push({\r\n                date: 0\r\n            });\r\n            dateDay++;\r\n        }\r\n    }\r\n}"]}